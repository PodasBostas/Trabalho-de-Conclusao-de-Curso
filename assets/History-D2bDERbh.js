import{S as f}from"./Sidebar-NAxYSlPT.js";import{B as D}from"./Back-Bp6Tgv2i.js";import{_ as b,c as s,b as v,a as r,t as i,e as a,F as h,f as k,o as n,g as l,w as y,r as w}from"./index-Dsej9PJs.js";const C={name:"History",components:{Sidebar:f,Back:D},data(){return{dockerfileHistory:[],dockercomposeHistory:[],loading:!0,error:null,showDockerfileHistory:!1,showDockerComposeHistory:!1}},methods:{async fetchDockerfileHistory(){const o=localStorage.getItem("token");if(!o){this.error="Token não encontrado. Faça login novamente.",this.loading=!1;return}try{const e=await fetch("https://api-fad.onrender.com/dockerfileHistory",{method:"GET",headers:{Authorization:`Bearer ${o}`,"Content-Type":"application/json"}});if(!e.ok)throw new Error("Erro ao carregar o histórico de Dockerfiles.");const u=await e.json();this.dockerfileHistory=u.history||[],this.showDockerfileHistory=!0,this.showDockerComposeHistory=!1}catch(e){console.error(e),this.error=e.message||"Erro ao carregar o histórico de Dockerfiles."}finally{this.loading=!1}},async fetchDockerComposeHistory(){const o=localStorage.getItem("token");if(!o){this.error="Token não encontrado. Faça login novamente.",this.loading=!1;return}try{const e=await fetch("https://api-fad.onrender.com/dockerComposeHistory",{method:"GET",headers:{Authorization:`Bearer ${o}`,"Content-Type":"application/json"}});if(!e.ok)throw new Error("Erro ao carregar o histórico de Docker Compose.");const u=await e.json();this.dockercomposeHistory=u.history||[],this.showDockerfileHistory=!1,this.showDockerComposeHistory=!0}catch(e){console.error(e),this.error=e.message||"Erro ao carregar o histórico de Docker Compose."}finally{this.loading=!1}},async deleteDockerfile(o){const e=localStorage.getItem("token");if(!e){this.error="Token não encontrado. Faça login novamente.";return}try{if(!(await fetch("https://api-fad.onrender.com/dockerfileHistoryDelete",{method:"DELETE",headers:{Authorization:`Bearer ${e}`,"Content-Type":"application/json"},body:JSON.stringify({_id:o})})).ok)throw new Error("Erro ao excluir o Dockerfile.");this.dockerfileHistory=this.dockerfileHistory.filter(p=>p._id!==o)}catch(u){console.error(u),this.error=u.message||"Erro ao excluir o Dockerfile."}},async deleteDockerCompose(o){const e=localStorage.getItem("token");if(!e){this.error="Token não encontrado. Faça login novamente.";return}try{if(!(await fetch("https://api-fad.onrender.com/dockerComposeHistoryDelete",{method:"DELETE",headers:{Authorization:`Bearer ${e}`,"Content-Type":"application/json"},body:JSON.stringify({_id:o})})).ok)throw new Error("Erro ao excluir o Docker Compose.");this.dockercomposeHistory=this.dockercomposeHistory.filter(p=>p._id!==o)}catch(u){console.error(u),this.error=u.message||"Erro ao excluir o Docker Compose."}},async createDockerfile(o){const e=localStorage.getItem("token");if(!e){this.error="Token não encontrado. Faça login novamente.";return}const u={title:o.base_image,base_image:o.base_image,framework:o.framework,dependencies:o.dependencies,gpu_support:o.gpu_support,env_vars:o.env_vars,ports:o.ports,startup_script:o.startup_script,use_requirements:o.use_requirements};try{const p=await fetch("https://api-fad.onrender.com/createDockerfileHistory",{method:"POST",headers:{Authorization:`Bearer ${e}`,"Content-Type":"application/json"},body:JSON.stringify(u)});if(!p.ok)throw new Error("Erro ao criar o Dockerfile.");const m=await p.blob(),d=document.createElement("a");d.href=URL.createObjectURL(m),d.download="Dockerfile",d.click()}catch(p){console.error(p),this.error=p.message||"Erro ao criar o Dockerfile."}},async createDockerCompose(o){const e=localStorage.getItem("token");if(!e){this.error="Token não encontrado. Faça login novamente.";return}const u={title:o.base_image,base_image:o.base_image,framework:o.framework,dependencies:o.dependencies,gpu_support:o.gpu_support,env_vars:o.env_vars,ports:o.ports,startup_script:o.startup_script,use_requirements:o.use_requirements};try{const p=await fetch("https://api-fad.onrender.com/createDockerComposeHistory",{method:"POST",headers:{Authorization:`Bearer ${e}`,"Content-Type":"application/json"},body:JSON.stringify(u)});if(!p.ok)throw new Error("Erro ao criar o Docker Compose.");const m=await p.blob(),d=document.createElement("a");d.href=URL.createObjectURL(m),d.download="docker-compose.yml",d.click()}catch(p){console.error(p),this.error=p.message||"Erro ao criar o Docker Compose."}}}},H={id:"history-page"},S={class:"container"},E={class:"buttons"},T={key:0},N={key:1,class:"error"},B={key:2},j={key:0},q={key:0},x={key:1},F={key:2},I={key:3},L={key:4},z={key:5},A={key:6},O={key:7},U={key:8},P=["onSubmit"],R=["onSubmit"],V={key:1},G={key:3},J={key:0},M={key:0},K={key:1},Q={key:2},W={key:3},X={key:4},Y={key:5},Z={key:6},$={key:7},ee={key:8},te={key:9},re=["onSubmit"],oe=["onSubmit"],se={key:1};function ne(o,e,u,p,m,d){const _=w("Sidebar");return n(),s("div",H,[v(_),r("div",S,[e[29]||(e[29]=r("h1",null,"Histórico",-1)),r("div",E,[r("button",{onClick:e[0]||(e[0]=(...t)=>d.fetchDockerfileHistory&&d.fetchDockerfileHistory(...t))},"Histórico de Dockerfiles"),r("button",{onClick:e[1]||(e[1]=(...t)=>d.fetchDockerComposeHistory&&d.fetchDockerComposeHistory(...t))},"Histórico de Docker Compose")]),m.loading?(n(),s("div",T,"Carregando histórico...")):m.error?(n(),s("div",N,i(m.error),1)):a("",!0),m.showDockerfileHistory?(n(),s("div",B,[e[14]||(e[14]=r("h2",null,"Histórico de Dockerfiles",-1)),m.dockerfileHistory.length>0?(n(),s("div",j,[(n(!0),s(h,null,k(m.dockerfileHistory,(t,c)=>(n(),s("div",{key:t._id,class:"dockerfile-card"},[r("h3",null,"Dockerfile #"+i(c+1),1),t.base_image?(n(),s("p",q,[e[2]||(e[2]=r("strong",null,"Imagem Base:",-1)),l(" "+i(t.base_image),1)])):a("",!0),t.framework?(n(),s("p",x,[e[3]||(e[3]=r("strong",null,"Framework:",-1)),l(" "+i(t.framework),1)])):a("",!0),t.dependencies?(n(),s("p",F,[e[4]||(e[4]=r("strong",null,"Dependências:",-1)),l(" "+i(t.dependencies),1)])):a("",!0),t.gpu_support?(n(),s("p",I,[e[5]||(e[5]=r("strong",null,"Suporte a GPU:",-1)),l(" "+i(t.gpu_support?"Sim":"Não"),1)])):a("",!0),t.env_vars?(n(),s("p",L,[e[6]||(e[6]=r("strong",null,"Variáveis de Ambiente:",-1)),l(" "+i(t.env_vars),1)])):a("",!0),t.ports?(n(),s("p",z,[e[7]||(e[7]=r("strong",null,"Portas:",-1)),l(" "+i(t.ports),1)])):a("",!0),t.startup_script?(n(),s("p",A,[e[8]||(e[8]=r("strong",null,"Script de Inicialização:",-1)),l(" "+i(t.startup_script),1)])):a("",!0),t.use_requirements?(n(),s("p",O,[e[9]||(e[9]=r("strong",null,"Usar Requirements:",-1)),l(" "+i(t.use_requirements?"Sim":"Não"),1)])):a("",!0),t.created_at?(n(),s("p",U,[e[10]||(e[10]=r("strong",null,"Criado em:",-1)),l(" "+i(new Date(t.created_at).toLocaleString()),1)])):a("",!0),r("pre",null,i(t.content),1),r("form",{onSubmit:y(g=>d.deleteDockerfile(t._id),["prevent"])},e[11]||(e[11]=[r("button",{type:"submit",class:"button-delete"},"Excluir",-1)]),40,P),r("form",{onSubmit:y(g=>d.createDockerfile(t),["prevent"])},e[12]||(e[12]=[r("button",{type:"submit",class:"button-create"},"Criar Dockerfile",-1)]),40,R)]))),128))])):(n(),s("div",V,e[13]||(e[13]=[r("p",null,"Não há histórico de Dockerfiles para este usuário.",-1)])))])):a("",!0),m.showDockerComposeHistory?(n(),s("div",G,[e[28]||(e[28]=r("h2",null,"Histórico de Docker Compose",-1)),m.dockercomposeHistory.length>0?(n(),s("div",J,[(n(!0),s(h,null,k(m.dockercomposeHistory,(t,c)=>(n(),s("div",{key:t._id,class:"dockerfile-card"},[r("h3",null,"Docker Compose #"+i(c+1),1),t.service_name?(n(),s("p",M,[e[15]||(e[15]=r("strong",null,"Nome do Serviço:",-1)),l(" "+i(t.service_name),1)])):a("",!0),t.base_image?(n(),s("p",K,[e[16]||(e[16]=r("strong",null,"Imagem Base:",-1)),l(" "+i(t.base_image),1)])):a("",!0),t.framework?(n(),s("p",Q,[e[17]||(e[17]=r("strong",null,"Framework:",-1)),l(" "+i(t.framework),1)])):a("",!0),t.dependencies?(n(),s("p",W,[e[18]||(e[18]=r("strong",null,"Dependências:",-1)),l(" "+i(t.dependencies),1)])):a("",!0),t.gpu_support?(n(),s("p",X,[e[19]||(e[19]=r("strong",null,"Suporte a GPU:",-1)),l(" "+i(t.gpu_support?"Sim":"Não"),1)])):a("",!0),t.env_vars?(n(),s("p",Y,[e[20]||(e[20]=r("strong",null,"Variáveis de Ambiente:",-1)),l(" "+i(t.env_vars),1)])):a("",!0),t.ports?(n(),s("p",Z,[e[21]||(e[21]=r("strong",null,"Portas:",-1)),l(" "+i(t.ports),1)])):a("",!0),t.startup_script?(n(),s("p",$,[e[22]||(e[22]=r("strong",null,"Script de Inicialização:",-1)),l(" "+i(t.startup_script),1)])):a("",!0),t.use_requirements?(n(),s("p",ee,[e[23]||(e[23]=r("strong",null,"Usar Requirements:",-1)),l(" "+i(t.use_requirements?"Sim":"Não"),1)])):a("",!0),t.created_at?(n(),s("p",te,[e[24]||(e[24]=r("strong",null,"Criado em:",-1)),l(" "+i(new Date(t.created_at).toLocaleString()),1)])):a("",!0),r("pre",null,i(t.content),1),r("form",{onSubmit:y(g=>d.deleteDockerCompose(t._id),["prevent"])},e[25]||(e[25]=[r("button",{type:"submit",class:"button-delete"},"Excluir",-1)]),40,re),r("form",{onSubmit:y(g=>d.createDockerCompose(t),["prevent"])},e[26]||(e[26]=[r("button",{type:"submit",class:"button-create"},"Criar Docker Compose",-1)]),40,oe)]))),128))])):(n(),s("div",se,e[27]||(e[27]=[r("p",null,"Não há histórico de Docker Compose para este usuário.",-1)])))])):a("",!0)])])}const ue=b(C,[["render",ne],["__scopeId","data-v-51d3a574"]]);export{ue as default};
